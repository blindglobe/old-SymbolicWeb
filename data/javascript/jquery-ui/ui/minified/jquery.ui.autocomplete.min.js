(function(a){a.widget("ui.autocomplete",{_init:function(){var b=this;this.cache={};this.element.addClass("ui-autocomplete").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(c){var d=a.ui.keyCode;switch(c.keyCode){case d.PAGE_UP:b.move("previousPage");break;case d.PAGE_DOWN:b.move("nextPage");break;case d.UP:b.move("previous");c.preventDefault();break;case d.DOWN:b.move("next");c.preventDefault();break;case d.ENTER:case d.TAB:if(!b.menu||!b.menu.active){return}c.preventDefault();b.select();break;case d.ESCAPE:b.element.val(b.term);b.close();break;case 16:case 17:case 18:break;default:clearTimeout(b.searching);b.searching=setTimeout(function(){b.search()},b.options.delay);break}}).focus(function(){b.previous=b.element.val()}).blur(function(){clearTimeout(b.searching);b.closing=setTimeout(function(){b.close()},150)});this.initSource()},destroy:function(){},initSource:function(){if(a.isArray(this.options.source)){var c=this.options.source;this.source=function(e,d){var f=new RegExp(a.ui.autocomplete.escapeRegex(e.term),"i");return a.grep(c,function(g){return f.test(g)})}}else{if(typeof this.options.source=="string"){var b=this.options.source;this.source=function(e,d){a.getJSON(b,e,d)}}else{this.source=this.options.source}}},search:function(e){var d=this;clearTimeout(d.closing);e=e!==undefined?e:this.element.val();if(e.length>=this.options.minLength){if(this._trigger("search")===false){return}d.element.addClass("ui-autocomplete-loading");d.term=this.element.val();function c(f){if(f.length){f=d.normalize(f);d._trigger("open");d.suggest(f)}else{d.close()}d.element.removeClass("ui-autocomplete-loading")}var b=this.source({term:e},c);if(b){c(b)}}else{d.close()}},close:function(b){clearTimeout(this.closing);if(this.menu){this._trigger("close");this.menu.element.remove();this.menu=null}if(this.previous!=this.element.val()){this._trigger("change",null,b)}},normalize:function(b){return a.map(b,function(c){if(typeof c=="string"){return{label:c,result:c}}return a.extend({label:c.label||c.result,result:c.result||c.label},c)})},suggest:function(c){(this.menu&&this.menu.element.remove());var b=this,d=a("<ul></ul>");a.each(c,function(e,f){a("<li></li>").data("item.autocomplete",f).append("<a>"+f.label+"</a>").appendTo(d)});d.addClass("ui-autocomplete-menu").appendTo(document.body).menu({focus:function(e,f){b._trigger("focus",null,{item:f.item.data("item.autocomplete")});b.element.val(f.item.data("item.autocomplete").result)},selected:function(e,g){var f=g.item.data("item.autocomplete");b.element.val(f.result);b.close({item:f});b.previous=f.result;b.element.focus()}}).removeClass("ui-corner-all").addClass("ui-corner-bottom").position({my:"left top",at:"left bottom",of:this.element});this.menu=d.data("menu");if(d.width()<=this.element.width()){d.width(this.element.width())}},move:function(b){if(!this.menu){this.search();return}if(this.menu.first()&&/^previous/.test(b)||this.menu.last()&&/^next/.test(b)){this.element.val(this.term);this.menu.deactivate();return}this.menu[b]()},select:function(){this.menu.select()},widget:function(){return this.menu&&this.menu.element||a([])}});a.extend(a.ui.autocomplete,{defaults:{minLength:1,delay:300},escapeRegex:function(b){return b.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")}})})(jQuery);